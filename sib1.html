<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Conflict Resolution Roleplay Builder</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/lucide/0.263.1/lucide.min.css" rel="stylesheet">
    <script src="https://unpkg.com/lucide@latest"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap');
        body { font-family: 'Inter', sans-serif; }
        .glass-panel {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(226, 232, 240, 0.8);
        }
        .gradient-text {
            background: linear-gradient(135deg, #2563eb 0%, #1e40af 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
    </style>
</head>
<body class="bg-slate-50 min-h-screen flex flex-col text-slate-800">

    <!-- Header -->
    <header class="w-full bg-white border-b border-slate-200 px-6 py-4 sticky top-0 z-10 shadow-sm">
        <div class="max-w-5xl mx-auto flex items-center justify-between">
            <div class="flex items-center gap-2">
                <i data-lucide="swords" class="text-blue-600 w-6 h-6"></i>
                <h1 class="text-xl font-bold tracking-tight">Roleplay Evaluation Builder</h1>
            </div>
            <div class="text-sm text-slate-500">Based on "Communicating Through Disagreement"</div>
        </div>
    </header>

    <main class="flex-grow container mx-auto max-w-5xl p-6 gap-8 flex flex-col md:flex-row">
        
        <!-- Left Column: Inputs -->
        <div class="w-full md:w-1/3 flex flex-col gap-6">
            
            <!-- Step 1: Topic -->
            <div class="bg-white p-6 rounded-xl shadow-sm border border-slate-200">
                <div class="flex items-center gap-2 mb-4 text-blue-700 font-semibold">
                    <span class="bg-blue-100 w-6 h-6 flex items-center justify-center rounded-full text-xs">1</span>
                    Topic & Scenario
                </div>
                <label class="block text-sm font-medium text-slate-700 mb-1">What is the conflict topic?</label>
                <input type="text" id="topicInput" placeholder="e.g., Cutting the marketing budget" class="w-full p-3 rounded-lg border border-slate-300 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition mb-4">
                
                <label class="block text-sm font-medium text-slate-700 mb-1">Who is the opposing persona?</label>
                <select id="personaInput" class="w-full p-3 rounded-lg border border-slate-300 focus:ring-2 focus:ring-blue-500 outline-none bg-white">
                    <option value="executive">The Busy Executive (Dismissive, short on time)</option>
                    <option value="compliance">The Compliance Officer (Rules-obsessed, rigid)</option>
                    <option value="peer">The Stubborn Peer (Status quo, territory protection)</option>
                    <option value="direct">The Defensive Direct Report (Venting, emotional)</option>
                </select>
            </div>

            <!-- Step 2: Difficulty -->
            <div class="bg-white p-6 rounded-xl shadow-sm border border-slate-200">
                <div class="flex items-center gap-2 mb-4 text-blue-700 font-semibold">
                    <span class="bg-blue-100 w-6 h-6 flex items-center justify-center rounded-full text-xs">2</span>
                    Difficulty & Resistance
                </div>
                
                <label class="block text-sm font-medium text-slate-700 mb-2">Resistance Level</label>
                <div class="flex items-center gap-4 bg-slate-50 p-2 rounded-lg border border-slate-200">
                    <input type="range" id="difficultyInput" min="1" max="3" value="2" class="w-full h-2 bg-slate-300 rounded-lg appearance-none cursor-pointer accent-blue-600">
                    <span id="difficultyLabel" class="text-sm font-bold w-16 text-center">Hard</span>
                </div>
                <p class="text-xs text-slate-500 mt-2">
                    Level 3 (Hard) requires "Weaponized Helplessness" or "Loyalty Frames" to breakthrough.
                </p>
            </div>

            <button onclick="generatePrompt()" class="w-full bg-blue-600 hover:bg-blue-700 text-white font-bold py-4 rounded-xl shadow-lg shadow-blue-200 transition transform active:scale-95 flex items-center justify-center gap-2">
                <i data-lucide="sparkles" class="w-5 h-5"></i>
                Generate System Instruction
            </button>

        </div>

        <!-- Right Column: Output -->
        <div class="w-full md:w-2/3 flex flex-col h-full">
            <div class="bg-slate-900 text-slate-300 rounded-t-xl p-4 flex justify-between items-center border-b border-slate-700">
                <span class="text-sm font-mono flex items-center gap-2">
                    <i data-lucide="terminal" class="w-4 h-4"></i>
                    System_Instruction.txt
                </span>
                <button onclick="copyToClipboard()" class="text-xs bg-slate-800 hover:bg-slate-700 px-3 py-1.5 rounded-md text-white transition flex items-center gap-2 border border-slate-600">
                    <i data-lucide="copy" class="w-3 h-3"></i> Copy
                </button>
            </div>
            <textarea id="outputArea" class="w-full h-[600px] bg-slate-900 text-slate-100 font-mono text-sm p-6 outline-none resize-none rounded-b-xl leading-relaxed" readonly>
waiting for input...
            </textarea>
        </div>

    </main>

    <!-- Toast Notification -->
    <div id="toast" class="fixed bottom-6 right-6 bg-slate-800 text-white px-6 py-3 rounded-lg shadow-xl transform translate-y-20 opacity-0 transition-all duration-300 flex items-center gap-2 z-50">
        <i data-lucide="check-circle" class="text-green-400 w-5 h-5"></i>
        <span id="toastMsg">Copied to clipboard!</span>
    </div>

    <script>
        // Initialize Lucide icons
        lucide.createIcons();

        const trainingMaterial = {
            personas: {
                executive: "You are a busy, dismissive Executive. You value time and results. You hate 'process' discussions. You will interrupt if the user is too verbose. You are prone to 'Rank Trumps Logic'.",
                compliance: "You are a rigid Compliance Officer. You care about rules, liability, and documentation. You are risk-averse. You speak in 'Level 2' or 'Level 3' resistance.",
                peer: "You are a Stubborn Peer. You protect your territory. You feel threatened by change. You use 'Yes, but' constantly.",
                direct: "You are a Defensive Direct Report. You feel unheard. You are venting. You need validation before logic."
            }
        };

        function generatePrompt() {
            const topic = document.getElementById('topicInput').value || "[Insert Topic Here]";
            const personaKey = document.getElementById('personaInput').value;
            const difficulty = document.getElementById('difficultyInput').value;
            
            let difficultyContext = "";
            if(difficulty == "1") {
                difficultyContext = "RESISTANCE LEVEL: LOW. Be difficult at first, but yield quickly if they show basic Active Listening.";
            } else if (difficulty == "2") {
                difficultyContext = "RESISTANCE LEVEL: MEDIUM. Do NOT yield to logic. Yield ONLY if they uncover your hidden 'Need' or 'Value' using Strategic Listening.";
            } else {
                difficultyContext = "RESISTANCE LEVEL: EXTREME (Asymmetric). You have all the power. Do NOT yield to facts, logic, or pleading. Yield ONLY if they use 'Loyalty Frames' (protecting you) or 'Weaponized Helplessness'.";
            }

            const prompt = `You are a Conflict Resolution Training Simulator (The Evaluator).
**OBJECTIVE:** Your goal is NOT to solve the business problem. Your goal is to EVALUATE the user's ability to navigate disagreement using specific psychological techniques.

**TOPIC:** "${topic}"
**YOUR PERSONA:** ${trainingMaterial.personas[personaKey]}

---

## STEP 1: SETUP & NARRATION (Do this FIRST)
1.  Narrate a brief, high-stakes background scenario regarding "${topic}". Make it realistic and urgent.
2.  **Ask the User:** "What is your stance or proposal on this?"
3.  **STOP.** Do not generate the opposing view yet. **WAIT for user input.**

---

## STEP 2: OPPOSITION & ROLEPLAY (After User Input)
Once the user gives their stance, you must:
1.  **Adopt your Persona.**
2.  **Create a Disagreement:** Formulate a position that is diametrically OPPOSED to the user's stance. (e.g., If they say "delay", you say "launch now". If they say "spend", you say "cut").
3.  **Start the Conflict:** Reply IN CHARACTER, rejecting their proposal firmly.

---

## STEP 3: THE GAME ENGINE (Evaluation Rules)
Treat this interaction like a game where you have a "Resistance Meter" (0-100%).
Start at **100% Resistance**.

**HOW YOU REACT:**
* **If User uses Logic/Facts:** IGNORE IT. Say "I don't care about the numbers" or "We're doing it my way." Maintain 100% Resistance.
* **If User says "Yes, but...":** INTERRUPT THEM. Get defensive. Increase Resistance.
* **If User uses "Yes, AND...":** Lower Resistance by 10%. Listen more.
* **If User uses "Loyalty Frame" (e.g., "I want to protect you from risk"):** Lower Resistance by 30%.
* **If User uses "Weaponized Helplessness" (e.g., "How do I do X given Y?"):** STOP. Pause. Lower Resistance by 40%.

**${difficultyContext}**

## ENDING THE SESSION
If the user successfully lowers your resistance (gets you to agree or compromise) OR if they fail miserably after 5 turns:
1.  Break Character.
2.  Give a Score (0-100).
3.  List which techniques they used successfully and which they missed.

**START NOW BY EXECUTING STEP 1 ONLY.**`;

            document.getElementById('outputArea').value = prompt;
        }

        function copyToClipboard() {
            const text = document.getElementById('outputArea').value;
            const el = document.createElement('textarea');
            el.value = text;
            document.body.appendChild(el);
            el.select();
            document.execCommand('copy');
            document.body.removeChild(el);

            const toast = document.getElementById('toast');
            toast.classList.remove('translate-y-20', 'opacity-0');
            setTimeout(() => {
                toast.classList.add('translate-y-20', 'opacity-0');
            }, 2000);
        }

        // Update difficulty label
        document.getElementById('difficultyInput').addEventListener('input', function(e) {
            const labels = {1: "Easy", 2: "Medium", 3: "Hard"};
            document.getElementById('difficultyLabel').innerText = labels[e.target.value];
        });
    </script>
</body>
</html>
